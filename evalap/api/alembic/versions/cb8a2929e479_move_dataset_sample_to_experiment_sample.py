"""move dataset.sample to experiment.sample

Revision ID: cb8a2929e479
Revises: a9542353ac06
Create Date: 2025-11-24 17:20:23.175949

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = 'cb8a2929e479'
down_revision: Union[str, None] = 'a9542353ac06'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    """
    Apply the database migration that moves the `sample` column from `datasets` to `experiments`.
    
    Drops the `sample` column on the `datasets` table and adds a nullable JSON `sample` column to the `experiments` table.
    """
    op.drop_column('datasets', 'sample')
    op.add_column('experiments', sa.Column('sample', sa.JSON(), nullable=True))
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    """
    Revert the migration by moving the `sample` column from `experiments` back to `datasets`.
    
    Drops the `sample` column from the `experiments` table and adds a `sample` column to the `datasets` table with PostgreSQL `JSON` type (astext_type=sa.Text()), `nullable=True`, and `autoincrement=False`.
    """
    op.drop_column('experiments', 'sample')
    op.add_column('datasets', sa.Column('sample', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True))
    # ### end Alembic commands ###